日志：
23:29:38
info
开始研究主题: 家居装修
23:29:38
info
🚀 开始研究: 家居装修
23:29:38
success
进入阶段: 规划
23:29:38
info
📡 连接小红书MCP服务...
23:29:38
success
✅ MCP连接成功
23:29:38
info
📋 [Planner] 分析研究主题...
23:30:09
success
📋 [Planner] 生成了 7 个搜索关键词
23:30:09
info
💡 理解: 用户希望获取家居装修的实用指南，核心诉求是了解设计、预算、材料等关键环节的操作技巧，尤其关注省钱策略和常见陷阱规避，以实现经济高效的居住空间改造。
23:30:09
info
📊 维度: 预算控制, 设计风格, 材料选购, 施工流程, 避坑指南
23:30:09
info
- 装修 分享
23:30:09
info
- 装修 省钱
23:30:09
info
- 小户型 装修
23:30:09
info
- 装修 避雷
23:30:09
info
- 装修 材料
23:30:09
info
- 装修 流程
23:30:09
info
- 旧房 装修
23:30:09
info
📐 [阶段1统计] 关键词: 7个 | 维度: 5个 | LLM调用: 1次
23:30:09
success
进入阶段: 搜索
23:30:09
info
🔍 [Searcher] 开始搜索笔记...
23:34:00
info
[Searcher] 开始搜索 7 个关键词
23:34:00
info
[Searcher] 搜索关键词 [1/7]: 装修 分享
23:34:00
info
[Searcher] 找到 1 篇笔记
23:34:00
info
[Searcher] 获取详情 [1/1]: 抄作业成功，恭喜我住进了Dream house ！...
23:34:00
info
[Searcher] 搜索关键词 [2/7]: 装修 省钱
23:34:00
info
[Searcher] 找到 0 篇笔记
23:34:00
info
[Searcher] 搜索关键词 [3/7]: 小户型 装修
23:34:00
info
[Searcher] 找到 0 篇笔记
23:34:00
info
[Searcher] 搜索关键词 [4/7]: 装修 避雷
23:34:00
info
[Searcher] 找到 1 篇笔记
23:34:00
info
[Searcher] 获取详情 [1/1]: 你可能不认识我，但一定看过我的避雷！...
23:34:00
info
[Searcher] 搜索关键词 [5/7]: 装修 材料
23:34:00
info
[Searcher] 找到 0 篇笔记
23:34:00
info
[Searcher] 搜索关键词 [6/7]: 装修 流程
23:34:00
info
[Searcher] 找到 1 篇笔记
23:34:00
info
[Searcher] 获取详情 [1/1]: 新手必看！毛坯房装修全流程 21 步详解...
23:34:00
info
[Searcher] 搜索关键词 [7/7]: 旧房 装修
23:34:00
info
[Searcher] 找到 0 篇笔记
23:34:00
info
[Searcher] 搜索完成，共收集 3 篇笔记，总计 3 篇
23:34:00
success
🔍 [Searcher] 收集了 3 篇笔记
23:34:00
info
📊 [统计] 共 28 张图片，总文本 1708 字，平均每篇 569 字
23:34:00
success
进入阶段: 分析
23:34:00
info
🧠 [Analyzer] 分析数据中...
23:34:38
success
🧠 [Analyzer] 提取了 3 条核心发现
23:34:38
info
📐 [阶段3统计] 分析笔记: 3篇 | 提取发现: 3条 | LLM调用: 1次
23:34:38
info
🖼️ [ImageAnalyzer] VLM分析图片...
23:36:56
success
🖼️ [ImageAnalyzer] 分析了 19 张图片，16 张可用
23:36:56
info
📐 [阶段4统计] 分类: 实景:16, 攻略:2, 未分类:1 | VLM调用: 3次
23:36:56
success
进入阶段: 生成
23:36:56
info
📑 [OutlineGenerator] 生成结构化大纲（含图片上下文）...
23:38:37
success
📑 [OutlineGenerator] 生成了 7 个章节
23:38:37
info
📐 [阶段5统计] 章节数: 7 | LLM调用: 1次
23:38:37
info
🎯 [ImageAssigner] 分配图片到章节...
23:39:07
info
[ImageAssigner] 章节'材料选择与维护策略' 匹配分数过低(7<8)，生成1张
23:39:07
info
[ImageAssigner] 章节'常见陷阱与避雷指南' 匹配分数过低(7<8)，生成1张
23:39:07
success
🎯 [ImageAssigner] 分配了 15 张图片
23:39:07
info
📐 [阶段6统计] 分配图片: 15张
23:39:07
info
📝 [Writer] 生成图文交错报告...
23:42:23
success
✅ 报告生成完成！
23:42:23
info
📐 [阶段7统计] 报告HTML长度: 19028字符 | 章节数: 7 | LLM调用: 8次
23:42:23
success
加载了 7 个结构化章节
23:42:23
success
研究完成！点击"编辑大纲"继续
耗时
12:45

问题：
1. 加入笔记搜索重试机制
2. 共 28 张图片，为什么只分析了 19 张图片（是因为只有19张的链接能访问吗？），16 张可用，还生成1张，最后选用了15张？（这里的整体逻辑是怎样的？详细说明数据流）
3.所有的prompt统一管理放在/prompt中。
4.总耗时分阶段统计，哪些阶段可以优化

![alt text](image.png)
图片按钮都不可用，生成封面，生成内容图都不可用，保存草稿不可用，预览不可用。
数据持久化方案，
如何生成docker images